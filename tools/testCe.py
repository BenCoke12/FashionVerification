import re
import numpy as np
import onnxruntime as ort
import ast
#import tensorflow as tf
#from tensorflow import keras
import idx2numpy

def testCounterexample(index, epsilon, perturbation):
    #original image and label
    original_image = idx2numpy.convert_from_file('../idxdata/individuals/Image' + str(index) + '.idx')[0]
    original_label = idx2numpy.convert_from_file('../idxdata/individuals/Label' + str(index) + '.idx')[0]

    #counterexample should be "+" for pert2
    counterexample = original_image - perturbation

    #Check it is a valid image
    criterion = (counterexample <= 1) & (counterexample >= 0)
    print("Valid image criterion satisfied on all pixels: ", criterion.all())

    #check it is epsilon distance from the original image
    epsilon
    print("Within epsilon distance: ", np.allclose(original_image, counterexample, rtol=0, atol=epsilon + 0.00001))

    #Check a robustness counterexample causes a missclassification
    #ort
    ortSession = ort.InferenceSession("../onnxnetworks/fashion1l32n.onnx")

    #original image classified label
    image = np.array([np.array(row) for row in original_image])
    imageForRuntime = image.astype(np.float32)
    imageReshape = np.array([imageForRuntime])
    ort_inputs = {ortSession.get_inputs()[0].name: imageReshape}
    original_image_prediction = ortSession.run(None, ort_inputs)

    #counterexample classified label
    image = np.array([np.array(row) for row in counterexample])
    imageForRuntime = image.astype(np.float32)
    imageReshape = np.array([imageForRuntime])
    ort_inputs = {ortSession.get_inputs()[0].name: imageReshape}
    counterexample_prediction = ortSession.run(None, ort_inputs)

    print("Original image predicted label: ", np.argmax(original_image_prediction))
    print("Counterexample predicted label: ", np.argmax(counterexample_prediction))
    print("True Label: ", original_label)
    print("Counterexample predictions: ", counterexample_prediction)

    #assert(original label == classified label)
    np.testing.assert_allclose(original_image, counterexample, rtol=0, atol=epsilon)


#i=104, eps = 0.15
pert11 = np.array([[-0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, -0.15, 0.0, 0.0, -0.15, -0.15, 0.0, -0.15, -0.15, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15], [-0.15, -0.15, -0.15, 0.0, -0.15, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0], [-0.15, 0.0, 0.0, -0.15, 0.0, 0.0, -2.8807e-2, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, -0.15, -0.15, 0.0], [0.0, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, -0.15, -0.15, -0.15, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15], [0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, -0.15, -0.15, 0.0, -0.15], [-0.15, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0], [-0.15, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, -0.15, 7.84313725490196e-3, -0.14999986274509805, 0.0, 0.0, -0.15, -0.1500002745098039, 2.3529411764705882e-2, 0.0, 0.0, 0.0, -0.150000431372549, -0.15, -0.15000029411764706, 1.96078431372549e-2, 7.84313725490196e-3, 0.0], [-0.15, -0.15, -0.15, -0.15, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0, 1.1764705882352941e-2, 0.0, 0.0, -0.15, 0.14999988235294118, 0.1499997254901961, 0.15000011764705878, -0.14999956862745104, 0.14999986274509805, 0.0, 1.568627450980392e-2, 3.92156862745098e-3, -0.15, 3.92156862745098e-3, 0.0, -0.15, 0.0, 0.0], [-0.15, 0.0, -0.15, 0.0, 0.0, -0.15, -0.15, 0.0, -0.15, 0.0, -0.15, -0.15, 0.13725490196078433, 0.150000431372549, 0.15, -0.1499996470588235, 0.1499997843137255, 0.15000009803921566, -0.15000047058823532, 0.0, 0.0, -0.15, 1.96078431372549e-2, 0.0, 1.568627450980392e-2, 0.1499998235294118, -0.14999976470588236, 0.0], [0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 3.92156862745098e-3, 0.0, 0.0, 0.0, -0.15000017647058825, 0.1499997843137255, 0.15, 0.15000047058823532, -0.15000013725490197, 0.15000039215686276, 0.1500001960784314, 0.15000017647058822, -0.1500002549019608, 0.15000017647058828, -0.14999970588235295, 0.0, -0.15, 0.0, 0.14999990196078436, 0.1500003725490196, -0.1500002745098039, 0.0], [-0.15, 7.84313725490196e-3, 1.1764705882352941e-2, 7.84313725490196e-3, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15000011764705884, 0.15000035294117647, -0.14999994117647059, -0.1500002745098039, -0.1500001960784314, 0.15000029411764706, 0.14999968627450982, -4.705882352941182e-2, 0.15000023529411766, -0.14117647058823535, 0.14999988235294112, 0.15000049019607845, -0.1500000980392157, 0.1499999607843137, 0.15000011764705887, -0.1499995490196078, 0.15000035294117653, -0.1499998431372549, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.15000000000000002, 0.15000011764705884, 0.15000007843137253, 0.14999982352941174, 0.14999998039215684, 0.14999980392156861, 0.15000021568627447, 0.1499997647058823, 0.15000001960784318, 0.15000013725490197, 0.14999982352941174, 0.1499996666666667, 0.14999994117647056, 0.15000049019607842, 0.14999980392156864, -7.843137254901966e-2, -9.411764705882353e-2, 0.15000029411764704, 0.14999990196078436, 0.14999972549019608, -0.12941176470588234, 3.529411764705882e-2], [0.0, 2.7450980392156862e-2, 0.15000009803921568, 0.15000041176470588, 0.14999984313725492, -0.15000031372549025, -0.14999960784313723, 0.14999966666666664, 0.14999966666666664, -0.14999956862745098, 0.1499998235294118, 0.15000019607843135, 0.149999568627451, 0.1500004509803922, 0.14999950980392157, 0.14999950980392157, 0.1500001568627451, 0.14999950980392152, 0.15000009803921574, 0.15000009803921574, 0.1500003725490196, 0.14999964705882357, 0.1500000784313725, -0.12941176470588234, 0.1500002745098039, 0.14999972549019608, 0.15000035294117647, 6.666666666666667e-2], [-0.15000013725490194, 0.1500003333333333, -0.14999956862745098, -0.15000001960784315, 0.15000035294117645, 0.14999966666666667, 0.14999958823529408, 0.15000049019607845, 0.15000017647058822, 0.14999978431372543, -0.14999978431372551, 0.15000000000000005, 0.149999862745098, -0.1499997450980392, 0.14999980392156864, -0.15000039215686276, 0.149999568627451, 0.15000035294117647, 0.1499997647058824, 0.14999978431372551, -8.62745098039216e-2, 0.1500000784313725, 0.15000009803921574, 0.15000025490196078, 0.1499999803921568, 0.14999972549019608, -0.15000017647058825, -0.15000029411764706], [0.15000003921568622, 0.1500002745098039, 0.15000035294117653, -0.14999978431372551, 0.14999964705882352, 0.14999972549019608, 0.14999970588235295, 0.14999972549019608, 0.1500003333333333, -0.14999992156862746, 0.15000037254901963, 0.1499999803921568, 0.14999952941176464, 0.14999992156862743, 0.1500004705882353, 0.1500001960784314, 0.14999974509803918, 0.14999984313725492, 0.1500004509803922, 0.15000011764705887, 0.15000029411764704, 0.15000000000000005, 0.14999970588235295, 0.15000001960784318, 0.15000013725490197, 0.15000001960784318, 0.14999988235294118, 0.15000023529411763], [0.14901960784313725, -0.14999982352941177, 0.1500000392156863, -0.15000029411764706, 0.14999996078431369, 0.15000041176470585, 0.15000041176470585, 0.14999984313725487, 0.15000013725490197, -0.15000043137254898, -0.1500003137254902, 0.1499997647058824, 0.1500001960784314, 0.14999952941176464, -0.15000027450980394, 0.14999988235294112, 0.1500000392156863, 0.1499997647058823, 0.1500000392156863, 0.15000029411764704, 0.14999988235294112, 0.14999988235294112, 0.14999954901960788, 0.1500002745098039, -0.14999999999999997, 0.14999988235294112, 0.1499996666666667, 5.4901960784313725e-2], [-0.15, 0.15000021568627453, 0.1499996274509804, 0.1499999215686275, 0.14999978431372543, -0.15000039215686276, 0.15000029411764704, 0.1500002745098039, 0.14999968627450982, -0.15000017647058825, 0.14999970588235295, 0.15000043137254895, 0.1499997647058823, 0.14999964705882352, 0.1499999411764706, 0.15000007843137253, 0.15000007843137253, -0.1499999607843137, 0.15000047058823532, 0.15000019607843135, 0.15000049019607845, -0.15000023529411768, -0.14999962745098036, -0.15000003921568628, 0.14999970588235298, -0.15000000000000002, -0.14999950980392154, 2.7450980392156862e-2], [0.0, 0.0, -0.1500000392156863, 0.15000035294117653, 0.14999952941176464, 0.15000009803921574, 0.15000000000000005, 0.15000017647058822, -0.15000011764705887, 0.15000007843137253, 0.14999996078431374, -0.14999960784313723, 0.14999998039215687, 0.14999996078431374, 0.15000049019607845, 0.15000035294117653, -0.14999968627450985, 0.1500000588235294, 0.15000007843137253, 0.14999980392156867, -0.1500000588235294, 0.15000035294117653, -0.14999994117647059, 0.1499999411764706, 0.1500000588235294, 0.15000001960784318, 0.14999978431372551, -0.1499998431372549], [0.0, -0.15, 0.0, 0.0, 9.411764705882353e-2, 0.14999992156862746, 0.15000005882352946, 0.14999999999999997, 0.1500002352941176, 0.15000047058823532, 0.14999960784313726, 0.1500004509803922, 0.15000031372549016, 0.15000031372549016, 0.1500003333333333, -0.15000009803921563, -0.15000021568627456, 0.14999966666666664, 0.15000009803921566, 0.15000039215686276, -0.1499998823529412, 0.1500001372549019, 0.14999999999999997, -0.15000011764705884, 0.15000005882352946, 0.14999974509803923, -0.15000039215686276, -0.15], [0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0], [-0.15, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, -0.15, 0.0, 0.0], [0.0, -0.15, -0.15, 0.0, -0.15, -0.15, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0], [-0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0], [0.0, 0.0, -0.15, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15, -0.15, -0.15, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0], [-0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0], [0.0, -0.15, 0.0, 0.0, 0.0, -0.15, -0.15, -0.15, -0.15, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.15, 0.0, -0.15, 0.0, 0.0, 0.0, -0.15]])
#i=30, eps = 0.15
pert12 = np.array([[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.3529411764705882e-2, 0.0, 0.0, 0.0, 0.0, 3.137254901960784e-2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.84313725490196e-3, 0.0, 0.0, 9.803921568627451e-2, 0.15000001960784315, 0.14999960784313723, 0.0, 0.0, 7.84313725490196e-3, 3.92156862745098e-3, 3.92156862745098e-3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.92156862745098e-3, 0.0, 0.0, 0.14999988235294118, 0.14999968627450982, 0.1499999411764706, 0.14999978431372543, 0.14999984313725487, 0.15000019607843137, 0.0, 7.84313725490196e-3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.7450980392156862e-2, 0.0, 0.14999988235294118, 0.1499996274509804, 0.0, 0.0, 0.0, 0.1500001568627451, 0.149999568627451, 0.15000025490196078, 0.0, 1.568627450980392e-2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1764705882352941e-2, 0.0, 0.1499999607843137, 0.14999972549019608, 0.0, 0.0, 0.0, 0.0, 0.0, 0.15000039215686276, 0.15000037254901963, 0.0, 1.96078431372549e-2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.3137254901960784e-2, 0.0, 0.1499996078431373, 0.14999990196078433, 0.0, 7.84313725490196e-3, 0.0, 0.0, 0.0, 0.0, 0.14999998039215687, 0.14999956862745098, 0.0, 1.568627450980392e-2, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.14999968627450974, 0.0, 0.0, 0.0, 0.0, 0.0, 7.84313725490196e-3, 0.0, 0.1499999607843137, 0.14999974509803923, 0.0, 3.529411764705882e-2, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 3.92156862745098e-3, 1.96078431372549e-2, 1.568627450980392e-2, 1.568627450980392e-2, 1.1764705882352941e-2, 1.1764705882352941e-2, 0.0, 0.0, 0.15000025490196084, 0.0, 0.0, 3.92156862745098e-3, 7.84313725490196e-3, 7.84313725490196e-3, 2.7450980392156862e-2, 0.0, 0.15000041176470588, 0.1500003137254902, 0.0, 1.1764705882352941e-2, 0.0, 3.92156862745098e-3, 3.92156862745098e-3, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.14999988235294118, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.14999966666666667, 0.1500001372549019, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 3.92156862745098e-3, 0.0, 0.0, 0.14999972549019608, 3.92156862745098e-3, 1.568627450980392e-2, 0.0, 0.0, 0.0, 0.12156862745098039, 0.15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.15000045098039214, 0.15000025490196078, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.15000023529411763, 0.14999952941176464, 0.15000000000000005, 0.1500000392156863, 0.149999568627451, 0.15000047058823532, 0.1500001372549019, 0.14999980392156867, 0.1500001568627451, 0.15000045098039214, 0.15000031372549016, 0.15000047058823532, 0.15000019607843135, 0.14999990196078436, 0.149999862745098, 0.14999984313725492, 0.14999996078431374, 0.1499999411764706, 0.14999964705882354, 0.14999988235294112, 0.15000021568627447, 0.14999956862745095, 0.1500000196078431, 0.1499999215686275, 0.15000025490196078], [0.0, 0.0, 4.7058823529411764e-2, 0.14999962745098042, 0.15000047058823532, 0.15000041176470585, 0.14999974509803918, 0.15000019607843135, 0.1499999411764706, 0.1500003333333333, 0.14999984313725487, 0.15000041176470585, 0.14999960784313726, 0.15000047058823532, 0.1499999215686275, 0.14999964705882352, 0.1500000588235294, 0.14999990196078436, 0.1499997647058823, 0.15000021568627447, 0.14999958823529413, 0.14999956862745095, 0.15000029411764704, 0.15000001960784318, 0.15000041176470585, 0.1500003333333333, 0.14999976470588236, 7.84313725490196e-2], [0.0, 0.0, 0.1499998235294118, 4.7058823529411764e-2, 0.15000009803921566, 0.14999954901960788, 0.15000017647058822, 0.1500000392156863, 0.1500000588235294, 0.1500003333333333, 0.14999964705882352, 0.14999978431372543, 0.15000049019607845, 0.15000019607843135, 0.15000035294117653, 0.15000021568627447, 0.15000047058823532, 0.14999964705882352, 0.149999862745098, 0.15000017647058822, 0.14999962745098042, 0.1500003333333333, 0.15000001960784318, 0.14999988235294112, 0.15000000000000005, 0.1500003333333333, 0.1499996862745098, 0.0], [0.0, 0.0, 0.14999974509803926, 2.7450980392156862e-2, 0.1500004509803922, 0.15000009803921574, 0.15000029411764704, 0.14999988235294112, 0.15000035294117653, 0.14999966666666664, 0.1499999215686275, 0.1500003333333333, 0.15000049019607845, 0.1500003333333333, 0.15000029411764704, 0.15000029411764704, 0.15000047058823532, 0.1499996274509804, 0.1499996274509804, 0.15000041176470585, 0.15000000000000002, 0.15000013725490197, 0.14999990196078436, 0.1500004509803922, 0.15000031372549016, 0.14999958823529413, 0.15000009803921566, 3.92156862745098e-2], [0.0, 0.15000003921568628, 0.15000027450980397, 0.0, 0.1500000784313725, 0.14999994117647056, 0.15000011764705887, 0.15000013725490197, 0.1500000392156863, 0.14999998039215687, 0.14999960784313726, 0.15000001960784318, 0.14999950980392157, 0.1499999215686275, 0.15000041176470588, 0.14999998039215687, 0.149999862745098, 0.14999988235294112, 0.15000029411764704, 0.1500003725490196, 0.15000041176470588, 0.14999954901960788, 0.14999990196078436, 0.15000031372549016, 0.1500004509803922, 0.14999984313725487, 0.15000019607843135, 4.7058823529411764e-2], [0.0, 0.1500003137254902, 0.14999988235294118, 0.0, 0.15000033333333335, 0.15000023529411766, 0.15000025490196078, 0.14999996078431369, 0.1499999803921568, 0.15000001960784318, 0.1500000588235294, 0.1500003333333333, 0.149999862745098, 0.15000043137254895, 0.15000013725490197, 0.14999954901960788, 0.15000011764705887, 0.15000039215686273, 0.14999992156862743, 0.1500000980392157, 0.15000007843137253, 0.14999958823529408, 0.15000009803921574, 0.15000041176470585, 0.14999968627450982, 0.14999952941176464, 0.1499999803921568, 9.411764705882353e-2], [0.0, 0.1499999215686275, 0.0, 0.0, 0.15000015686274507, 0.14999996078431369, 0.14999982352941174, 0.15000009803921574, 0.14999952941176464, 0.15000011764705887, 0.149999568627451, 0.14999974509803918, 0.15000001960784318, 0.15000043137254895, 0.149999568627451, 0.14999964705882357, 0.15000029411764704, 0.15000039215686273, 0.15000031372549016, 0.14999950980392157, 0.1499996274509804, 0.15000015686274515, 0.15000019607843135, 0.14999994117647056, 0.15000041176470585, 0.14999952941176464, 0.15000035294117647, 0.11372549019607843], [0.0, 0.14999990196078436, 0.0, 0.0, 0.15, 0.15000025490196078, 0.14999996078431369, 0.14999996078431369, 0.14999982352941174, 0.15000041176470585, 0.14999954901960788, 0.15000043137254895, 0.14999972549019608, 0.14999954901960788, 0.1500001568627451, 0.14999954901960788, 0.15000013725490197, 0.14999968627450982, 0.14999980392156864, 0.1500000196078431, 0.14999964705882354, 0.15000037254901963, 0.14999968627450982, 0.14999952941176464, 0.1499996666666667, 0.15000009803921574, 0.1499996078431372, 0.15000000000000002], [0.0, 0.14999990196078436, 0.0, 0.10980392156862745, 0.15, 0.1499999803921568, 0.14999996078431369, 0.14999996078431369, 0.14999982352941174, 0.15000025490196078, 0.14999968627450982, 0.1500002745098039, 0.15000000000000005, 0.14999970588235295, 0.15000041176470585, 0.14999992156862743, 0.15000025490196078, 0.15000025490196078, 0.1500000784313725, 0.14999996078431369, 0.15000035294117653, 0.14999952941176464, 0.14999980392156864, 0.15000039215686273, 0.14999950980392152, 0.15000023529411766, 0.15, 0.1500003529411765], [0.0, 0.1499997647058823, 0.0, 0.14999950980392154, 0.15, 0.1500002745098039, 0.14999996078431369, 0.14999996078431369, 0.14999982352941174, 0.14999968627450982, 0.14999968627450982, 0.14999968627450982, 0.14999954901960788, 0.15000013725490197, 0.15000013725490197, 0.14999952941176464, 0.15000043137254895, 0.14999980392156864, 0.14999968627450982, 0.14999970588235295, 0.14999950980392152, 0.14999982352941174, 0.1499999803921568, 0.15000011764705887, 0.14999954901960788, 0.14999984313725487, 0.15, 0.14999986274509802], [0.0, 0.15000019607843135, 0.0, 0.14999984313725492, 0.15, 0.1500002745098039, 0.14999982352941174, 0.15000039215686273, 0.14999982352941174, 0.15000025490196078, 0.15000039215686273, 0.15000009803921574, 0.15000009803921574, 0.14999954901960788, 0.1500001568627451, 0.1500001568627451, 0.1500001568627451, 0.15000043137254895, 0.149999862745098, 0.1500002745098039, 0.14999970588235295, 0.14999954901960788, 0.14999982352941174, 0.14999952941176464, 0.14999952941176464, 0.15000011764705887, 0.15, 0.15000021568627453], [0.0, 0.1499995294117647, 0.0, 0.15000007843137253, 0.15, 0.149999862745098, 0.14999952941176464, 0.15000025490196078, 0.14999952941176464, 0.15000039215686273, 0.14999982352941174, 0.14999996078431369, 0.14999982352941174, 0.15000039215686273, 0.14999996078431369, 0.14999968627450982, 0.14999984313725487, 0.15000043137254895, 0.1500002745098039, 0.14999954901960788, 0.14999968627450982, 0.14999968627450982, 0.1499996666666667, 0.14999994117647056, 0.1499996666666667, 0.14999952941176464, 0.15, 0.14999956862745095], [0.0, 0.15000023529411763, 0.15000021568627453, 0.15000035294117645, 0.1500001960784314, 0.1500001568627451, 0.15000009803921574, 0.14999996078431369, 0.15000039215686273, 0.15000025490196078, 0.14999982352941174, 0.14999952941176464, 0.14999952941176464, 0.14999996078431369, 0.14999996078431369, 0.15000009803921574, 0.15000023529411766, 0.1500003725490196, 0.1499996666666667, 0.1499996666666667, 0.1499996666666667, 0.15000023529411766, 0.14999980392156864, 0.14999994117647056, 0.14999980392156864, 0.14999952941176464, 0.15, 0.1500001372549019], [0.0, 0.0, 0.14999998039215684, 0.15000033333333335, 0.14999964705882357, 0.15000043137254895, 0.15000011764705887, 0.14999996078431369, 0.15000009803921574, 0.1499996666666667, 0.1500003725490196, 0.14999950980392152, 0.14999950980392152, 0.14999950980392152, 0.14999964705882357, 0.1500000784313725, 0.1500000784313725, 0.1500000784313725, 0.15000021568627453, 0.15000021568627453, 0.14999964705882357, 0.15000021568627453, 0.14999964705882357, 0.15000035294117647, 0.15000035294117647, 0.14999994117647056, 0.15, 0.1499998235294118], [0.0, 0.0, 0.0, 0.1499996274509804, 0.15000045098039216, 0.15000035294117647, 0.15000023529411766, 0.15000023529411766, 0.14999994117647056, 0.15000021568627453, 0.15000021568627453, 0.1500003725490196, 0.14999996078431369, 0.1499996666666667, 0.15000023529411766, 0.1499996666666667, 0.14999952941176464, 0.14999996078431369, 0.14999952941176464, 0.15000009803921574, 0.1499996666666667, 0.15000023529411766, 0.14999980392156864, 0.14999950980392152, 0.14999950980392152, 0.14999980392156864, 0.14999962745098033, 0.14999984313725492], [0.0, 0.0, 0.0, 0.15000025490196084, 0.15000003921568625, 0.14999950980392152, 0.15000035294117647, 0.15000035294117647, 0.1500000784313725, 0.14999950980392152, 0.14999950980392152, 0.14999992156862743, 0.1500001960784314, 0.14999992156862743, 0.15000035294117647, 0.15000035294117647, 0.15000035294117647, 0.15000035294117647, 0.15000021568627453, 0.15000021568627453, 0.15000021568627453, 0.14999964705882357, 0.14999978431372551, 0.15000049019607842, 0.15000049019607842, 0.14999978431372551, 0.15000031372549022, 0.15000000000000005], [0.0, 0.0, 0.0, 0.15000005882352938, 0.1500001764705882, 0.15000035294117647, 0.15, 0.15, 0.15, 0.15, 0.15, 0.14999958823529408, 0.14999968627450982, 0.14999968627450982, 0.14999982352941174, 0.14999982352941174, 0.14999982352941174, 0.15000039215686273, 0.1499999803921568, 0.15000041176470585, 0.14999984313725487, 0.1499999803921568, 0.14999972549019608, 0.1499997647058823, 0.1500000588235294, 0.14999980392156867, 0.15000019607843135, 0.15000000000000002], [0.0, 0.0, 0.0, 1.568627450980392e-2, 0.1499998431372549, 0.1500003529411765, 0.15000003921568628, 0.1500004509803922, 0.15000003921568628, 0.14999950980392154, 0.14999968627450982, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]])
#network is hard coded
testCounterexample(30, 0.15, pert12)